import{a as I,b as f,e as a,h as b,f as e,w as o,u as l,z as H,i as d,q as m,t as h,A as ce,B as J,C as Q,D as X,F as W,y as _,_ as U,k as Y,G as Z,r as K,c as O,H as pe,o as _e,I as me,J as ge,K as fe,L as ve,M as we,E as G,N as je,O as ee,P as te,Q as oe,x as he}from"./index-3p_sB7V1.js";import{u as ne}from"./project-CkqIgJ0n.js";const ye={class:"card-header"},ke={class:"card-status"},$e={class:"card-content"},Ce=["title"],be=["title"],Pe={class:"project-meta"},Se={class:"upload-time"},De={class:"file-size"},ze={key:1,class:"progress-indicator"},Be=I({__name:"ProjectCard",props:{project:{},showActions:{type:Boolean,default:!0}},emits:["click","view","edit","delete"],setup(A,{emit:P}){const y=A,w=P,S=()=>{w("click",y.project)},D=t=>{switch(t){case"ready":case"completed":return"success";case"uploading":case"parsing":case"generating":return"warning";case"error":return"danger";default:return"info"}},u=t=>{switch(t){case"uploading":return"上传中";case"parsing":return"解析中";case"ready":return"就绪";case"generating":return"生成中";case"completed":return"已完成";case"error":return"错误";default:return"未知"}},k=t=>{switch(t){case"uploading":return 30;case"parsing":return 60;case"generating":return 80;default:return 0}},v=t=>new Date(t).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),s=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:t<1024*1024*1024?`${(t/1024/1024).toFixed(1)} MB`:`${(t/1024/1024/1024).toFixed(1)} GB`;return(t,c)=>{const p=d("el-icon"),C=d("el-tag"),z=d("el-button"),B=d("el-dropdown-item"),M=d("el-dropdown-menu"),V=d("el-dropdown"),F=d("el-progress");return _(),f("div",{class:"project-card",onClick:S},[a("div",ye,[e(p,{class:"file-icon"},{default:o(()=>[e(l(H))]),_:1}),a("div",ke,[e(C,{type:D(t.project.status),size:"small"},{default:o(()=>[m(h(u(t.project.status)),1)]),_:1},8,["type"])])]),a("div",$e,[a("h3",{class:"project-name",title:t.project.name},h(t.project.name),9,Ce),a("p",{class:"project-filename",title:t.project.fileName},h(t.project.fileName),9,be),a("div",Pe,[a("span",Se,h(v(t.project.uploadTime)),1),a("span",De,h(s(t.project.fileSize)),1)])]),t.showActions?(_(),f("div",{key:0,class:"card-actions",onClick:c[3]||(c[3]=ce(()=>{},["stop"]))},[e(V,{trigger:"click",placement:"bottom-end"},{dropdown:o(()=>[e(M,null,{default:o(()=>[e(B,{onClick:c[0]||(c[0]=T=>t.$emit("view",t.project))},{default:o(()=>[e(p,null,{default:o(()=>[e(l(Q))]),_:1}),c[4]||(c[4]=m(" 查看详情 "))]),_:1,__:[4]}),e(B,{onClick:c[1]||(c[1]=T=>t.$emit("edit",t.project))},{default:o(()=>[e(p,null,{default:o(()=>[e(l(X))]),_:1}),c[5]||(c[5]=m(" 编辑项目 "))]),_:1,__:[5]}),e(B,{onClick:c[2]||(c[2]=T=>t.$emit("delete",t.project)),divided:""},{default:o(()=>[e(p,null,{default:o(()=>[e(l(W))]),_:1}),c[6]||(c[6]=m(" 删除项目 "))]),_:1,__:[6]})]),_:1})]),default:o(()=>[e(z,{type:"text",size:"small",class:"action-button"},{default:o(()=>[e(p,null,{default:o(()=>[e(l(J))]),_:1})]),_:1})]),_:1})])):b("",!0),t.project.status==="uploading"||t.project.status==="parsing"||t.project.status==="generating"?(_(),f("div",ze,[e(F,{percentage:k(t.project.status),"show-text":!1,"stroke-width":3,status:"success"},null,8,["percentage"])])):b("",!0)])}}}),Me=U(Be,[["__scopeId","data-v-baf63990"]]),Te={class:"project-list"},Ve={class:"project-name-cell"},Fe=["title"],Ne=["title"],Ae={class:"status-cell"},Ee={key:0,class:"status-progress"},Le={class:"file-size"},Ye={class:"upload-time"},Ie={class:"action-buttons"},Ue=I({__name:"ProjectList",props:{projects:{},showActions:{type:Boolean,default:!0}},emits:["row-click","view","edit","delete"],setup(A,{emit:P}){const y=P,w=s=>{y("row-click",s)},S=s=>{switch(s){case"ready":case"completed":return"success";case"uploading":case"parsing":case"generating":return"warning";case"error":return"danger";default:return"info"}},D=s=>{switch(s){case"uploading":return"上传中";case"parsing":return"解析中";case"ready":return"就绪";case"generating":return"生成中";case"completed":return"已完成";case"error":return"错误";default:return"未知"}},u=s=>{switch(s){case"uploading":return 30;case"parsing":return 60;case"generating":return 80;default:return 0}},k=s=>new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),v=s=>s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:s<1024*1024*1024?`${(s/1024/1024).toFixed(1)} MB`:`${(s/1024/1024/1024).toFixed(1)} GB`;return(s,t)=>{const c=d("el-icon"),p=d("el-table-column"),C=d("el-tag"),z=d("el-progress"),B=d("el-button"),M=d("el-dropdown-item"),V=d("el-dropdown-menu"),F=d("el-dropdown"),T=d("el-table");return _(),f("div",Te,[e(T,{data:s.projects,onRowClick:w,stripe:"",style:{width:"100%"},"header-cell-style":{background:"#fafafa",color:"#606266"}},{default:o(()=>[e(p,{prop:"name",label:"项目名称","min-width":"200"},{default:o(({row:r})=>[a("div",Ve,[e(c,{class:"file-icon"},{default:o(()=>[e(l(H))]),_:1}),a("span",{class:"project-name",title:r.name},h(r.name),9,Fe)])]),_:1}),e(p,{prop:"fileName",label:"文件名","min-width":"180"},{default:o(({row:r})=>[a("span",{class:"filename",title:r.fileName},h(r.fileName),9,Ne)]),_:1}),e(p,{prop:"status",label:"状态",width:"120"},{default:o(({row:r})=>[a("div",Ae,[e(C,{type:S(r.status),size:"small"},{default:o(()=>[m(h(D(r.status)),1)]),_:2},1032,["type"]),r.status==="uploading"||r.status==="parsing"||r.status==="generating"?(_(),f("div",Ee,[e(z,{percentage:u(r.status),"show-text":!1,"stroke-width":2,status:"success"},null,8,["percentage"])])):b("",!0)])]),_:1}),e(p,{prop:"fileSize",label:"文件大小",width:"100"},{default:o(({row:r})=>[a("span",Le,h(v(r.fileSize)),1)]),_:1}),e(p,{prop:"uploadTime",label:"上传时间",width:"160"},{default:o(({row:r})=>[a("span",Ye,h(k(r.uploadTime)),1)]),_:1}),s.showActions?(_(),Y(p,{key:0,label:"操作",width:"100",fixed:"right"},{default:o(({row:r})=>[a("div",Ie,[e(F,{trigger:"click",placement:"bottom-end"},{dropdown:o(()=>[e(V,null,{default:o(()=>[e(M,{onClick:E=>s.$emit("view",r)},{default:o(()=>[e(c,null,{default:o(()=>[e(l(Q))]),_:1}),t[0]||(t[0]=m(" 查看详情 "))]),_:2,__:[0]},1032,["onClick"]),e(M,{onClick:E=>s.$emit("edit",r)},{default:o(()=>[e(c,null,{default:o(()=>[e(l(X))]),_:1}),t[1]||(t[1]=m(" 编辑项目 "))]),_:2,__:[1]},1032,["onClick"]),e(M,{onClick:E=>s.$emit("delete",r),divided:""},{default:o(()=>[e(c,null,{default:o(()=>[e(l(W))]),_:1}),t[2]||(t[2]=m(" 删除项目 "))]),_:2,__:[2]},1032,["onClick"])]),_:2},1024)]),default:o(()=>[e(B,{type:"text",size:"small"},{default:o(()=>[e(c,null,{default:o(()=>[e(l(J))]),_:1})]),_:1})]),_:2},1024)])]),_:1})):b("",!0)]),_:1},8,["data"])])}}}),Re=U(Ue,[["__scopeId","data-v-4d19ac10"]]),Ke={class:"project-manager"},Oe={class:"search-filter-section"},Ge={class:"search-box"},qe={class:"filter-controls"},xe={class:"view-controls"},He={class:"view-toggle"},Je={class:"results-info"},Qe={class:"results-count"},Xe={key:0},We={class:"project-list-container"},Ze={key:0,class:"projects-content"},et={key:0,class:"projects-grid"},tt={class:"new-card-content"},ot={class:"new-card-icon"},nt={class:"new-card-button"},st={key:1,class:"projects-table"},lt={key:1,class:"empty-state"},at={key:0,class:"pagination-container"},rt=I({__name:"ProjectManager",props:{showActions:{type:Boolean,default:!0}},emits:["project-click","project-edit","project-delete","upload-file"],setup(A,{emit:P}){const y=P,w=ne(),{projects:S,loading:D,pagination:u,viewMode:k}=Z(w),v=K(""),s=K(""),t=K(null),c=O(()=>{let i=[...S.value];if(i.sort((n,j)=>new Date(j.uploadTime).getTime()-new Date(n.uploadTime).getTime()),v.value){const n=v.value.toLowerCase();i=i.filter(j=>j.name.toLowerCase().includes(n)||j.fileName.toLowerCase().includes(n))}if(s.value&&(i=i.filter(n=>n.status===s.value)),t.value&&t.value.length===2){const[n,j]=t.value;i=i.filter(R=>{const $=new Date(R.uploadTime).toISOString().split("T")[0];return $>=n&&$<=j})}return i}),p=O(()=>{const i=(u.value.page-1)*u.value.pageSize,n=i+u.value.pageSize;return c.value.slice(i,n)}),C=O(()=>!!(v.value||s.value||t.value)),z=()=>{u.value.page=1,r()},B=()=>{v.value="",u.value.page=1,r()},M=()=>{u.value.page=1,r()},V=()=>{u.value.page=1,r()},F=()=>{v.value="",s.value="",t.value=null,u.value.page=1,r()},T=i=>{w.setViewMode(i)},r=()=>{u.value.total=c.value.length},E=i=>{u.value.pageSize=i,u.value.page=1,r()},se=i=>{u.value.page=i},L=i=>{y("project-click",i)},q=i=>{y("project-edit",i)},x=async i=>{try{await we.confirm(`确定要删除项目 "${i.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),w.deleteProject(i.id),G.success("项目删除成功"),y("project-delete",i),r(),p.value.length===0&&u.value.page>1&&(u.value.page-=1)}catch{}};return pe([v,s,t],()=>{r()},{deep:!0}),_e(()=>{w.loadProjects(),r()}),(i,n)=>{const j=d("el-icon"),R=d("el-input"),$=d("el-option"),le=d("el-select"),ae=d("el-date-picker"),N=d("el-button"),re=d("el-button-group"),ie=d("el-empty"),de=d("el-pagination"),ue=ge("loading");return _(),f("div",Ke,[a("div",Oe,[a("div",Ge,[e(R,{modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=g=>v.value=g),placeholder:"搜索项目名称或文件名...",clearable:"",onInput:z,onClear:B},{prefix:o(()=>[e(j,null,{default:o(()=>[e(l(je))]),_:1})]),_:1},8,["modelValue"])]),a("div",qe,[e(le,{modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=g=>s.value=g),placeholder:"筛选状态",clearable:"",onChange:M,style:{width:"140px"}},{default:o(()=>[e($,{label:"全部状态",value:""}),e($,{label:"上传中",value:"uploading"}),e($,{label:"解析中",value:"parsing"}),e($,{label:"就绪",value:"ready"}),e($,{label:"生成中",value:"generating"}),e($,{label:"已完成",value:"completed"}),e($,{label:"错误",value:"error"})]),_:1},8,["modelValue"]),e(ae,{modelValue:t.value,"onUpdate:modelValue":n[2]||(n[2]=g=>t.value=g),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:V,style:{width:"240px"}},null,8,["modelValue"])])]),a("div",xe,[a("div",He,[e(re,null,{default:o(()=>[e(N,{type:l(k)==="card"?"primary":"default",onClick:n[3]||(n[3]=g=>T("card")),size:"small"},{default:o(()=>[e(j,null,{default:o(()=>[e(l(ee))]),_:1}),n[9]||(n[9]=m(" 卡片 "))]),_:1,__:[9]},8,["type"]),e(N,{type:l(k)==="list"?"primary":"default",onClick:n[4]||(n[4]=g=>T("list")),size:"small"},{default:o(()=>[e(j,null,{default:o(()=>[e(l(te))]),_:1}),n[10]||(n[10]=m(" 列表 "))]),_:1,__:[10]},8,["type"])]),_:1})]),a("div",Je,[a("span",Qe,[m(" 共 "+h(l(u).total)+" 个项目 ",1),C.value?(_(),f("span",Xe,"（已筛选）")):b("",!0)])])]),me((_(),f("div",We,[p.value.length>0?(_(),f("div",Ze,[l(k)==="card"?(_(),f("div",et,[a("div",{class:"new-project-card",onClick:n[5]||(n[5]=g=>i.$emit("upload-file"))},[a("div",tt,[a("div",ot,[e(j,null,{default:o(()=>[e(l(oe))]),_:1})]),n[12]||(n[12]=a("h3",{class:"new-card-title"},"新建标书",-1)),n[13]||(n[13]=a("p",{class:"new-card-desc"}," 支持 PDF、DOC、DOCX 格式文件上传 ",-1)),a("div",nt,[e(N,{type:"primary",size:"large"},{default:o(()=>n[11]||(n[11]=[m(" 上传招标文件 ")])),_:1,__:[11]})])])]),(_(!0),f(fe,null,ve(p.value,g=>(_(),Y(Me,{key:g.id,project:g,"show-actions":i.showActions,onClick:L,onView:L,onEdit:q,onDelete:x},null,8,["project","show-actions"]))),128))])):b("",!0),l(k)==="list"?(_(),f("div",st,[e(Re,{projects:p.value,"show-actions":i.showActions,onRowClick:L,onView:L,onEdit:q,onDelete:x},null,8,["projects","show-actions"])])):b("",!0)])):l(D)?b("",!0):(_(),f("div",lt,[e(ie,{description:C.value?"没有找到匹配的项目":"暂无项目","image-size":120},{default:o(()=>[C.value?(_(),Y(N,{key:1,onClick:F},{default:o(()=>n[15]||(n[15]=[m(" 清除筛选条件 ")])),_:1,__:[15]})):(_(),Y(N,{key:0,type:"primary",onClick:n[6]||(n[6]=g=>i.$emit("upload-file"))},{default:o(()=>n[14]||(n[14]=[m(" 上传第一个文件 ")])),_:1,__:[14]}))]),_:1},8,["description"])]))])),[[ue,l(D)]]),l(u).total>0?(_(),f("div",at,[e(de,{"current-page":l(u).page,"onUpdate:currentPage":n[7]||(n[7]=g=>l(u).page=g),"page-size":l(u).pageSize,"onUpdate:pageSize":n[8]||(n[8]=g=>l(u).pageSize=g),"page-sizes":[10,20,50,100],total:l(u).total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:E,onCurrentChange:se},null,8,["current-page","page-size","total"])])):b("",!0)])}}}),it=U(rt,[["__scopeId","data-v-0c5188a0"]]),dt={class:"projects-content"},ut={class:"projects-header"},ct={class:"projects-actions"},pt={class:"view-toggle"},_t=I({__name:"Projects",setup(A){const P=he(),y=ne(),{viewMode:w}=Z(y),S=s=>{y.setViewMode(s)},D=s=>{P.push(`/files/preview/${s.id}`)},u=s=>{G.info("项目编辑功能开发中...")},k=s=>{G.success(`项目 "${s.name}" 已删除`)},v=()=>{P.push("/upload")};return(s,t)=>{const c=d("el-icon"),p=d("el-button"),C=d("el-button-group");return _(),f("div",dt,[a("div",ut,[t[6]||(t[6]=a("h1",{class:"projects-title"},"项目管理",-1)),a("div",ct,[a("div",pt,[e(C,null,{default:o(()=>[e(p,{type:l(w)==="card"?"primary":"default",onClick:t[0]||(t[0]=z=>S("card")),size:"small"},{default:o(()=>[e(c,null,{default:o(()=>[e(l(ee))]),_:1}),t[3]||(t[3]=m(" 卡片 "))]),_:1,__:[3]},8,["type"]),e(p,{type:l(w)==="list"?"primary":"default",onClick:t[1]||(t[1]=z=>S("list")),size:"small"},{default:o(()=>[e(c,null,{default:o(()=>[e(l(te))]),_:1}),t[4]||(t[4]=m(" 列表 "))]),_:1,__:[4]},8,["type"])]),_:1})]),e(p,{type:"primary",onClick:t[2]||(t[2]=z=>s.$router.push("/upload"))},{default:o(()=>[e(c,null,{default:o(()=>[e(l(oe))]),_:1}),t[5]||(t[5]=m(" 上传文件 "))]),_:1,__:[5]})])]),e(it,{onProjectClick:D,onProjectEdit:u,onProjectDelete:k,onUploadFile:v})])}}}),ft=U(_t,[["__scopeId","data-v-e3ebf43d"]]);export{ft as default};
